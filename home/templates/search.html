{% extends 'home/templates/base.html' %}

{% block body %}

<section>
<section>
        <div class="d-flex justify-content-center" style="width:100%;" >
            <div class="d-flex  flex-column" style=";width:80%;height:900px;background:#fffcf0;padding:20px 10px;">
                <div class="text-center fw-bold" style="width:100%;height:30px;">기본 검색 알고리즘</div>
                <div class="border d-flex flex-column " style="width:100%;height:30%;">
                    <div class="fw-bold d-flex justify-content-between" style="width:100%;height:10%;">
                        <div>linear search <input placeholder="검색 숫자" id="l_number" class="number_input" type="number"></div><div><button onclick="linearsearch();" >start</button></div>
                    </div>
                    <div class=" d-flex" style="width:100%;height:10%;">
                        <div style="width:50%">비교 횟수: <span id="s_compare">0</span></div><div style="width:50%">SWAP 횟수: <span id="s_swap">0</span></div>
                    </div>
                    <div class="" style="width:100%;height:90%;">
                        <div class="container  d-flex justify-content-center align-items-end" style="width:100%;height:100%;">
                            {% for i in array %}
                                <div class="border box linear" style="flex-grow:1;height:calc({{ i }}/100*100%);background:lightskyblue;" value="{{ i }}"> {{ i }}</div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <br>
                <div class="border d-flex flex-column " style="width:100%;height:30%;">
                    <div class="fw-bold d-flex justify-content-between" style="width:100%;height:10%;">
                        <div>binary search <input placeholder="검색 숫자" id="b_number" class="number_input" type="number"></div><div><button onclick="binarysearch();">start</button></div>
                    </div>
                    <div class=" d-flex" style="width:100%;height:10%;">
                        <div style="width:50%">비교 횟수: <span id="b_compare">0</span></div><div style="width:50%">SWAP 횟수: <span id="b_swap">0</span></div>
                    </div>
                    <div class="" style="width:100%;height:90%;">
                        <div class="container d-flex justify-content-center align-items-end" style="width:100%;height:100%;">
                            {% for i in array %}
                                <div class="border box binary_bar" style="flex-grow:1;height:calc({{ i }}/100*100%);background:lightskyblue;" value="{{ i }}"> {{ i }}</div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

            </div>
        </div>
</section>

{% endblock %}

{% block script %}
    <script>
        function background_change(obj, color){
            obj.style.background=color;
        }

        async function binarysearch(delay=300){
            var num = document.getElementById('b_number').value;
            if(num===''){
                alert('숫자를 입력해주세요');
            }
            else{
                var is_found = 0;
                var bars = document.querySelectorAll('.binary_bar');

                for (var i = 0; i < bars.length; i += 1) {
                    bars[i].style.backgroundColor = "skyblue";
                }

                var start = 0;
                var end = bars.length -1;


                while(start <= end){

                    var mid = Math.floor((start + end)/2);
                    background_change(bars[mid],'purple');

                    var value = parseInt(bars[mid].innerText);

                    await new Promise((resolve) =>
                      setTimeout(() => {
                        resolve();
                      }, delay)
                    );

                    if(value===num){
                        alert(`${num}발견!`);
                        background_change(bars[mid],'green');
                        is_found = 1;
                        break;
                    }
                    else if(value > num){
                        end = mid -1;
                    }
                    else{
                        start = mid + 1;
                    }
                    background_change(bars[mid],'purple');

                }
                if(!is_found){
                    alert(`${num}이/가 없습니다.`);
                }

            }
        }

        async function linearsearch (delay=600){
            var num = document.getElementById('l_number').value;
            if(num === ''){
                alert('숫자를 입력하세요.');
            }else{
                var is_found = 0;
                var bars = document.querySelectorAll('.linear');

                for(var i=0;i<bars.length;i++){
                    background_change(bars[i],'violet')

                    await new Promise((resolve)=>{
                        setTimeout(()=>{
                            resolve();
                        }, 300);
                    })

                    console.log(parseInt(bars[i].innerText))
                    console.log(parseInt(num))
                    if(parseInt(bars[i].innerText) === parseInt(num)){
                        is_found = 1;
                        background_change(bars[i],'green')

                        await new Promise((resolve)=>{
                            setTimeout(()=>{
                                resolve();
                            }, 300);
                        })
                        break;
                    }
                    else{
                        continue;
                    }
                }

                if(is_found===1){
                    alert(num + '발견!')
                }
                else{
                    alert(num + '을 찾지 못했습니다. ')
                }

            }
        }
    </script>
{% endblock %}